written by cs4213 Chun-Wei Shaw